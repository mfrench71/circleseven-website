---
layout: default
---

<div class="category-archive">
  {%- comment -%} Show breadcrumb navigation {%- endcomment -%}
  {% include category-breadcrumbs.html category=page.category %}

  <h1 class="page-heading">
    <i class="fas fa-folder category-icon"></i>
    {{ page.title }}
  </h1>

  {% if page.description %}
    <p class="category-description">{{ page.description }}</p>
  {% endif %}

  {%- comment -%} Check if this is a parent category with children {%- endcomment -%}
  {%- assign has_children = false -%}
  {%- assign child_categories = nil -%}
  {%- for parent in site.data.taxonomy.categories -%}
    {%- if parent.item == page.category -%}
      {%- if parent.children and parent.children.size > 0 -%}
        {%- assign has_children = true -%}
        {%- assign child_categories = parent.children -%}
      {%- endif -%}
      {%- break -%}
    {%- endif -%}
  {%- endfor -%}

  {%- comment -%} Show child categories if this is a parent {%- endcomment -%}
  {%- if has_children -%}
    <div class="child-categories-section mb-5">
      <h2 class="h5 fw-bold mb-4">
        <i class="fas fa-folder-tree me-2"></i>Subcategories
      </h2>
      <div class="row g-3">
        {%- for child in child_categories -%}
          {%- assign child_slug = child.slug | default: child.item | slugify -%}
          {%- assign child_posts = site.categories[child.item] | size -%}
          <div class="col-md-6">
            <a href="{{ site.baseurl }}/category/{{ child_slug }}/" class="text-decoration-none">
              <div class="border rounded p-3 h-100 bg-white hover-shadow d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                  <i class="fas fa-folder-open me-3 text-primary fs-5"></i>
                  <span class="fw-medium text-dark">{{ child.item }}</span>
                </div>
                <span class="badge bg-secondary rounded-pill ms-3">{{ child_posts }}</span>
              </div>
            </a>
          </div>
        {%- endfor -%}
      </div>
    </div>
  {%- endif -%}

  {%- assign total_posts = site.categories[page.category] | size -%}
  {%- assign posts_per_page = 12 -%}
  {%- assign total_pages = total_posts | divided_by: posts_per_page | plus: 1 -%}

  <div class="d-flex justify-content-between align-items-center mb-3">
    <p class="post-count-info mb-0">
      Showing <span id="showing-start">1</span>-<span id="showing-end">{{ posts_per_page | at_most: total_posts }}</span> of {{ total_posts }} posts
    </p>
    {%- if total_posts > posts_per_page -%}
    <div class="pagination-controls">
      <button id="prev-page" class="btn btn-sm btn-outline-secondary" disabled>
        <i class="fas fa-chevron-left"></i> Previous
      </button>
      <span class="mx-2">Page <span id="current-page">1</span> of {{ total_pages }}</span>
      <button id="next-page" class="btn btn-sm btn-outline-secondary">
        Next <i class="fas fa-chevron-right"></i>
      </button>
    </div>
    {%- endif -%}
  </div>

  <div class="post-grid" id="post-grid">
    {% for post in site.categories[page.category] %}
      <article class="post-card" data-post-index="{{ forloop.index0 }}">
        <!-- Card Image -->
        <div class="post-card-image">
          <a href="{{ post.url | relative_url }}">
            {% include post-card-image.html post=post %}
          </a>
        </div>

        <!-- Card Content -->
        <div class="post-card-content">
          <!-- Category Badge -->
          {% if post.categories.size > 0 %}
            {% assign display_category = post.categories | first %}
            <a href="{{ site.baseurl }}/category/{{ display_category | slugify }}/" class="category-badge badge-{{ display_category | slugify }}">
              {{ display_category }}
            </a>
          {% endif %}

          <!-- Title -->
          <h2 class="post-card-title">
            <a href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
          </h2>

          <!-- Excerpt -->
          {% if post.excerpt %}
            <p class="post-card-excerpt">{{ post.excerpt | strip_html | strip_newlines | truncatewords: 30 }}</p>
          {% endif %}

          <!-- Author & Meta -->
          <div class="post-card-meta">
            <img src="{% include gravatar-url.html email=site.email size=64 %}"
                 alt="{{ site.author | escape }}"
                 class="post-author-avatar"
                 loading="lazy"
                 onerror="this.src='{{ '/assets/images/default-avatar.svg' | relative_url }}'">
            <div class="post-meta-info">
              <span class="post-author-name">{{ site.author | escape }}</span>
              <span class="post-date-reading">
                <i class="far fa-calendar calendar-icon" aria-hidden="true"></i>
                {{ post.date | date: "%b %-d, %Y" }}
                {%- if post.content -%}
                  Â· {% include reading-time.html %}
                {%- endif -%}
              </span>
            </div>
          </div>
        </div>
      </article>
    {% endfor %}
  </div>

  {%- if total_posts > posts_per_page -%}
  <div class="d-flex justify-content-center mt-4">
    <div class="pagination-controls">
      <button id="prev-page-bottom" class="btn btn-sm btn-outline-secondary" disabled>
        <i class="fas fa-chevron-left"></i> Previous
      </button>
      <span class="mx-2">Page <span id="current-page-bottom">1</span> of {{ total_pages }}</span>
      <button id="next-page-bottom" class="btn btn-sm btn-outline-secondary">
        Next <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </div>

  <script>
  (function() {
    const postsPerPage = {{ posts_per_page }};
    const totalPosts = {{ total_posts }};
    const totalPages = Math.ceil(totalPosts / postsPerPage);
    let currentPage = 1;

    const allPosts = Array.from(document.querySelectorAll('.post-card'));
    const prevBtn = document.getElementById('prev-page');
    const nextBtn = document.getElementById('next-page');
    const prevBtnBottom = document.getElementById('prev-page-bottom');
    const nextBtnBottom = document.getElementById('next-page-bottom');
    const currentPageSpan = document.getElementById('current-page');
    const currentPageSpanBottom = document.getElementById('current-page-bottom');
    const showingStart = document.getElementById('showing-start');
    const showingEnd = document.getElementById('showing-end');

    function showPage(page) {
      const start = (page - 1) * postsPerPage;
      const end = start + postsPerPage;

      allPosts.forEach((post, index) => {
        if (index >= start && index < end) {
          post.style.display = '';
        } else {
          post.style.display = 'none';
        }
      });

      currentPage = page;
      currentPageSpan.textContent = page;
      currentPageSpanBottom.textContent = page;
      showingStart.textContent = start + 1;
      showingEnd.textContent = Math.min(end, totalPosts);

      prevBtn.disabled = page === 1;
      nextBtn.disabled = page === totalPages;
      prevBtnBottom.disabled = page === 1;
      nextBtnBottom.disabled = page === totalPages;

      // Scroll to top of post grid
      document.getElementById('post-grid').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    prevBtn.addEventListener('click', () => showPage(currentPage - 1));
    nextBtn.addEventListener('click', () => showPage(currentPage + 1));
    prevBtnBottom.addEventListener('click', () => showPage(currentPage - 1));
    nextBtnBottom.addEventListener('click', () => showPage(currentPage + 1));

    // Initialize: show only first page
    showPage(1);
  })();
  </script>
  {%- endif -%}
</div>
