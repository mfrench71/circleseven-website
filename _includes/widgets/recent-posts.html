<!-- Recent Posts Widget -->
<div class="widget widget-recent-posts">
  <h3 class="widget-title">Recent Posts</h3>
  <ul class="recent-posts-list">
    {% for post in site.posts limit:5 %}
    <li class="recent-post-item">
      {% if post.image or post.featured_image %}
      <div class="recent-post-thumbnail">
        <a href="{{ post.url | relative_url }}">
          {%- assign img_src = post.featured_image | default: post.image -%}
          {%- if img_src contains 'http' -%}
            {%- comment -%} Full URL (external or Cloudinary) - use as-is {%- endcomment -%}
            <img src="{{ img_src }}" alt="{{ post.title | escape }}" loading="lazy">
          {%- else -%}
            {%- comment -%} Filename/path only - construct Cloudinary URL with optimization {%- endcomment -%}
            {%- assign img_id = img_src | remove: '.jpg' | remove: '.png' | remove: '.gif' | remove: '.webp' | remove: '.jpeg' -%}
            <img
              src="{{ site.cloudinary_base_url }}/w_150,h_150,c_fill,q_auto,f_auto/{{ img_id }}"
              srcset="{{ site.cloudinary_base_url }}/w_150,h_150,c_fill,q_auto,f_auto/{{ img_id }} 150w,
                      {{ site.cloudinary_base_url }}/w_300,h_300,c_fill,q_auto,f_auto/{{ img_id }} 300w"
              sizes="150px"
              alt="{{ post.title | escape }}"
              loading="lazy"
            >
          {%- endif -%}
        </a>
      </div>
      {% endif %}
      <div class="recent-post-content">
        <h4 class="recent-post-title">
          <a href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
        </h4>
        <time class="recent-post-date" datetime="{{ post.date | date_to_xmlschema }}">
          <svg class="calendar-icon" xmlns="http://www.w3.org/2000/svg" width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          {{ post.date | date: "%b %-d, %Y" }}
        </time>
      </div>
    </li>
    {% endfor %}
  </ul>
</div>
